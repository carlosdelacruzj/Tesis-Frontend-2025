<div class="container-fluid dashboard-content">
    <!-- Titulo -->
    <h1>Administrar Equipos</h1>
    <!-- Grupos -->
    <mat-tab-group>
        <mat-tab label="Equipos Adquiridos">
            <div class="dashboard-ecommerce" *ngIf="esPrincipal">
                <div class="container-fluid">
                    <app-table-base-mejora
                        [columns]="columnasAdquiridos"
                        [data]="equiposAdquiridos"
                        [pageSizeOptions]="[5, 10, 25, 50]"
                        [pageSize]="5"
                        [showCreateButton]="false"
                        searchPlaceholder="Buscar por equipo, marca o modelo"
                        emptyText="Sin equipos registrados"
                        (rowClick)="seleccionarGrupo($event)">

                        <ng-template appCell="cantidad" let-row>
                            {{ row.cantidad ?? row.Cantidad ?? 0 }}
                        </ng-template>

                        <ng-template appCell="acciones" let-row>
                            <button mat-mini-fab color="primary"
                                (click)="$event.stopPropagation(); seleccionarGrupo(row)"
                                style="background-color: transparent; color: #101c30"
                                aria-label="Btn Ver">
                                <mat-icon>menu</mat-icon>
                            </button>
                        </ng-template>

                    </app-table-base-mejora>
                </div>
            </div>
            <div *ngIf="!esPrincipal">
                <!-- Boton para el registro de equipo -->
                <div>
                    <div style="position: absolute">
                        <button class="btn btn-primary btn-lg" (click)="esPrincipal = true; getEquipos()">
            <mat-icon>reply_all</mat-icon>
          </button>
                    </div>
                </div>
                <app-listarportipo [idEquipo]="idEquipo" [idMarca]="idMarca" [idModelo]="idModelo" [Modelo]="Modelo">
                </app-listarportipo>
            </div>
        </mat-tab>
        <mat-tab label="Equipos Alquilados">
            <div class="dashboard-ecommerce" *ngIf="isPrincipal">
                <div class="container-fluid">
                    <app-table-base-mejora
                        [columns]="columnasAlquilados"
                        [data]="equiposAlquilados"
                        [pageSizeOptions]="[5, 10, 25, 50]"
                        [pageSize]="5"
                        searchPlaceholder="Buscar equipo, serie o asignaciones"
                        emptyText="Sin equipos alquilados"
                        createButtonLabel="Registrar Equipo"
                        (createClick)="registrarAlquilado(contentCreate)"
                        (rowClick)="seleccionarAlquilado($event)">

                        <ng-template appCell="estado" let-row>
                            {{ row.estado ?? row.Estado ?? 'Sin estado' }}
                        </ng-template>

                        <ng-template appCell="acciones" let-row>
                            <button mat-mini-fab color="primary"
                                (click)="$event.stopPropagation(); seleccionarAlquilado(row)"
                                style="background-color: transparent; color: #101c30"
                                aria-label="Btn Ver">
                                <mat-icon>menu</mat-icon>
                            </button>
                        </ng-template>

                    </app-table-base-mejora>
                </div>
            </div>
            <div *ngIf="!isPrincipal">
                <!-- Boton para el registro de equipo -->
                <div>
                    <div style="position: absolute">
                        <button class="btn btn-primary btn-lg" (click)="isPrincipal = true; getEquiposAlquilados()">
            <mat-icon>reply_all</mat-icon>
          </button>
                    </div>
                </div>
                <app-detalles-alquilado [id]="id" [serie]="serie">
                </app-detalles-alquilado>
            </div>
        </mat-tab>
    </mat-tab-group>
</div>

<ng-template #contentCreate let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h3 class="modal-title mm" id="modal-basic-title">
            Registrar Equipo Alquilado
        </h3>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
    <span aria-hidden="true">&times;</span>
  </button>
    </div>
    <div class="modal-body">
        <form #EquipoCreateForm="ngForm">
            <mat-card class="card">
                <mat-card-content class="card-body" style="padding-top: 10px">
                    <div class="form-group">
                        <label class="col-form-label1">Tipo de Equipo</label>
                        <input type="text" class="form-control form-control-sm" name="tipoEquipo" #tipoEquipo="ngModel" [(ngModel)]="service.postAlquilado.tipoEquipo" />
                        <div *ngIf="tipoEquipo.errors?.required">
                            <p>*Campo Requerido</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-form-label1">Marca</label>
                        <input type="text" class="form-control form-control-sm" name="marca" #marca="ngModel" [(ngModel)]="service.postAlquilado.marca" />
                        <div *ngIf="marca.errors?.required">
                            <p>*Campo Requerido</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-form-label1">Modelo</label>
                        <input type="text" class="form-control form-control-sm" name="modelo" #modelo="ngModel" [(ngModel)]="service.postAlquilado.modelo" />
                        <div *ngIf="modelo.errors?.required">
                            <p>*Campo Requerido</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-form-label1">N° Serie</label>
                        <input type="text" class="form-control form-control-sm" name="serie" #serie="ngModel" [(ngModel)]="service.postAlquilado.serie" [pattern]="seriePattern" required />
                        <div *ngIf="serie.errors?.pattern">
                            <p>*Sólo se acepta el formato: AAA-000</p>
                        </div>
                        <div *ngIf="serie.errors?.required">
                            <p>*Campo Requerido</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-form-label1">Fecha Entrada</label>
                        <input type="text" class="form-control form-control-sm" name="fechaEntrada" #fechaEntrada="ngModel" [(ngModel)]="service.postAlquilado.fechaEntrada" readonly />
                    </div>
                    <div class="form-group">
                        <label class="col-form-label1">Fecha Salida</label>
                        <input type="date" class="form-control form-control-sm" name="fechaSalida" #fechaSalida="ngModel" [(ngModel)]="service.postAlquilado.fechaSalida" />
                    </div>
                    <div class="form-group">
                        <label class="col-form-label1">Proyecto</label><br />
                        <select mat-select name="fk_Pro_Cod" #fk_Pro_Cod="ngModel" [(ngModel)]="service.postAlquilado.fk_Pro_Cod">
            <option
              matInput
              *ngFor="let Proyecto of proyecto"
              [value]="Proyecto.ID"
            >
              {{ Proyecto.Nombre }}
            </option>
          </select>
                        <input type="text" class="form-control form-control-sm" name="fk_Pro_Cod" #fk_Pro_Cod="ngModel" [(ngModel)]="service.postAlquilado.fk_Pro_Cod" style="display: none" />
                    </div>
                    <div class="form-group">
                        <label class="col-form-label1">Miembro del Staff</label><br />
                        <select mat-select name="fk_Empleado_Cod" #fk_Empleado_Cod="ngModel" [(ngModel)]="service.postAlquilado.fk_Empleado_Cod">
            <option
              matInput
              *ngFor="let Empleado of empleado"
              [value]="Empleado.ID"
            >
              {{ Empleado.Nombre }} - {{ Empleado.Estado }}
            </option>
          </select>
                        <input type="text" class="form-control form-control-sm" name="fk_Empleado_Cod" #fk_Empleado_Cod="ngModel" [(ngModel)]="service.postAlquilado.fk_Empleado_Cod" style="display: none" />
                    </div>
                    <div class="form-group">
                        <label class="col-form-label1">Estado</label>
                        <input type="text" class="form-control form-control-sm" name="estado" value="ALQUILADO" #estado="ngModel" [(ngModel)]="service.postAlquilado.estado" readonly />
                    </div>
                </mat-card-content>
            </mat-card>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-dark" (click)="addAlquilado(EquipoCreateForm)">
    Registrar
  </button>
    </div>
</ng-template>
